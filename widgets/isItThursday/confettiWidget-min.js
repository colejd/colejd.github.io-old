function doConfetti(){var t=window.devicePixelRatio,i=Math.PI,s=Math.sqrt,e=Math.round,o=Math.random,n=Math.cos,h=Math.sin,r=window.requestAnimationFrame,a=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;!function(t){function i(t){var i=_now(),e=Math.max(0,16-(i-s)),o=setTimeout(t,e);return s=i,o}var s=(new Date).getTime(),e=t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.clearTimeout;r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||i,a=function(i){e.call(t,i)}}(window),document.addEventListener("DOMContentLoaded",function(){function c(t,i){this.x=t,this.y=i,this.Length=function(){return s(this.SqrLength())},this.SqrLength=function(){return this.x*this.x+this.y*this.y},this.Add=function(t){this.x+=t.x,this.y+=t.y},this.Sub=function(t){this.x-=t.x,this.y-=t.y},this.Div=function(t){this.x/=t,this.y/=t},this.Mul=function(t){this.x*=t,this.y*=t},this.Normalize=function(){var t=this.SqrLength();if(0!=t){var i=1/s(t);this.x*=i,this.y*=i}},this.Normalized=function(){var t=this.SqrLength();if(0!=t){var i=1/s(t);return new c(this.x*i,this.y*i)}return new c(0,0)}}function l(t,i,s,e){this.position=new c(t,i),this.mass=s,this.drag=e,this.force=new c(0,0),this.velocity=new c(0,0),this.AddForce=function(t){this.force.Add(t)},this.Integrate=function(t){var i=this.CurrentForce(this.position);i.Div(this.mass);var s=new c(this.velocity.x,this.velocity.y);s.Mul(t),this.position.Add(s),i.Mul(t),this.velocity.Add(i),this.force=new c(0,0)},this.CurrentForce=function(t,i){var s=new c(this.force.x,this.force.y),e=this.velocity.Length(),o=new c(this.velocity.x,this.velocity.y);return o.Mul(this.drag*this.mass*e),s.Sub(o),s}}function p(i,s){this.pos=new c(i,s),this.rotationSpeed=600*o()+800,this.angle=d*o()*360,this.rotation=d*o()*360,this.cosA=1,this.size=5,this.oscillationSpeed=1.5*o()+.5,this.xSpeed=40,this.ySpeed=60*o()+50,this.corners=new Array,this.time=o();var r=e(o()*(y.length-1));this.frontColor=y[r][0],this.backColor=y[r][1];for(var a=0;a<4;a++){var l=n(this.angle+d*(90*a+45)),u=h(this.angle+d*(90*a+45));this.corners[a]=new c(l,u)}this.Update=function(t){this.time+=t,this.rotation+=this.rotationSpeed*t,this.cosA=n(d*this.rotation),this.pos.x+=n(this.time*this.oscillationSpeed)*this.xSpeed*t,this.pos.y+=this.ySpeed*t,this.pos.y>p.bounds.y&&(this.pos.x=o()*p.bounds.x,this.pos.y=0)},this.Draw=function(i){this.cosA>0?i.fillStyle=this.frontColor:i.fillStyle=this.backColor,i.beginPath(),i.moveTo((this.pos.x+this.corners[0].x*this.size)*t,(this.pos.y+this.corners[0].y*this.size*this.cosA)*t);for(var s=1;s<4;s++)i.lineTo((this.pos.x+this.corners[s].x*this.size)*t,(this.pos.y+this.corners[s].y*this.size*this.cosA)*t);i.closePath(),i.fill()}}function u(i,r,a,p,f,x,w,v){this.particleDist=p,this.particleCount=a,this.particleMass=w,this.particleDrag=v,this.particles=new Array;var m=e(o()*(y.length-1));this.frontColor=y[m][0],this.backColor=y[m][1],this.xOff=n(d*x)*f,this.yOff=h(d*x)*f,this.position=new c(i,r),this.prevPosition=new c(i,r),this.velocityInherit=2*o()+4,this.time=100*o(),this.oscillationSpeed=2*o()+2,this.oscillationDistance=40*o()+40,this.ySpeed=40*o()+80;for(var T=0;T<this.particleCount;T++)this.particles[T]=new l(i,r-T*this.particleDist,this.particleMass,this.particleDrag);this.Update=function(t){var i=0;this.time+=t*this.oscillationSpeed,this.position.y+=this.ySpeed*t,this.position.x+=n(this.time)*this.oscillationDistance*t,this.particles[0].position=this.position;var e=this.prevPosition.x-this.position.x,o=this.prevPosition.y-this.position.y,h=s(e*e+o*o);for(this.prevPosition=new c(this.position.x,this.position.y),i=1;i<this.particleCount;i++){var r=c.Sub(this.particles[i-1].position,this.particles[i].position);r.Normalize(),r.Mul(h/t*this.velocityInherit),this.particles[i].AddForce(r)}for(i=1;i<this.particleCount;i++)this.particles[i].Integrate(t);for(i=1;i<this.particleCount;i++){var a=new c(this.particles[i].position.x,this.particles[i].position.y);a.Sub(this.particles[i-1].position),a.Normalize(),a.Mul(this.particleDist),a.Add(this.particles[i-1].position),this.particles[i].position=a}this.position.y>u.bounds.y+this.particleDist*this.particleCount&&this.Reset()},this.Reset=function(){this.position.y=-o()*u.bounds.y,this.position.x=o()*u.bounds.x,this.prevPosition=new c(this.position.x,this.position.y),this.velocityInherit=2*o()+4,this.time=100*o(),this.oscillationSpeed=2*o()+1.5,this.oscillationDistance=40*o()+40,this.ySpeed=40*o()+80;var t=e(o()*(y.length-1));this.frontColor=y[t][0],this.backColor=y[t][1],this.particles=new Array;for(var i=0;i<this.particleCount;i++)this.particles[i]=new l(this.position.x,this.position.y-i*this.particleDist,this.particleMass,this.particleDrag)},this.Draw=function(i){for(var s=0;s<this.particleCount-1;s++){var e=new c(this.particles[s].position.x+this.xOff,this.particles[s].position.y+this.yOff),o=new c(this.particles[s+1].position.x+this.xOff,this.particles[s+1].position.y+this.yOff);this.Side(this.particles[s].position.x,this.particles[s].position.y,this.particles[s+1].position.x,this.particles[s+1].position.y,o.x,o.y)<0?(i.fillStyle=this.frontColor,i.strokeStyle=this.frontColor):(i.fillStyle=this.backColor,i.strokeStyle=this.backColor),0==s?(i.beginPath(),i.moveTo(this.particles[s].position.x*t,this.particles[s].position.y*t),i.lineTo(this.particles[s+1].position.x*t,this.particles[s+1].position.y*t),i.lineTo(.5*(this.particles[s+1].position.x+o.x)*t,.5*(this.particles[s+1].position.y+o.y)*t),i.closePath(),i.stroke(),i.fill(),i.beginPath(),i.moveTo(o.x*t,o.y*t),i.lineTo(e.x*t,e.y*t),i.lineTo(.5*(this.particles[s+1].position.x+o.x)*t,.5*(this.particles[s+1].position.y+o.y)*t),i.closePath(),i.stroke(),i.fill()):s==this.particleCount-2?(i.beginPath(),i.moveTo(this.particles[s].position.x*t,this.particles[s].position.y*t),i.lineTo(this.particles[s+1].position.x*t,this.particles[s+1].position.y*t),i.lineTo(.5*(this.particles[s].position.x+e.x)*t,.5*(this.particles[s].position.y+e.y)*t),i.closePath(),i.stroke(),i.fill(),i.beginPath(),i.moveTo(o.x*t,o.y*t),i.lineTo(e.x*t,e.y*t),i.lineTo(.5*(this.particles[s].position.x+e.x)*t,.5*(this.particles[s].position.y+e.y)*t),i.closePath(),i.stroke(),i.fill()):(i.beginPath(),i.moveTo(this.particles[s].position.x*t,this.particles[s].position.y*t),i.lineTo(this.particles[s+1].position.x*t,this.particles[s+1].position.y*t),i.lineTo(o.x*t,o.y*t),i.lineTo(e.x*t,e.y*t),i.closePath(),i.stroke(),i.fill())}},this.Side=function(t,i,s,e,o,n){return(t-s)*(n-e)-(i-e)*(o-s)}}var d=i/180,y=[["#df0049","#660671"],["#00e857","#005291"],["#2bebbc","#05798a"],["#ffd200","#b06c00"]];c.Lerp=function(t,i,s){return new c((i.x-t.x)*s+t.x,(i.y-t.y)*s+t.y)},c.Distance=function(t,i){return s(c.SqrDistance(t,i))},c.SqrDistance=function(t,i){var s=t.x-i.x,e=t.y-i.y;return s*s+e*e+z*z},c.Scale=function(t,i){return new c(t.x*i.x,t.y*i.y)},c.Min=function(t,i){return new c(Math.min(t.x,i.x),Math.min(t.y,i.y))},c.Max=function(t,i){return new c(Math.max(t.x,i.x),Math.max(t.y,i.y))},c.ClampMagnitude=function(t,i){var s=t.Normalized;return new c(s.x*i,s.y*i)},c.Sub=function(t,i){return new c(t.x-i.x,t.y-i.y,t.z-i.z)},p.bounds=new c(0,0),u.bounds=new c(0,0),confetti={},confetti.Context=function(i){var s=0,e=document.getElementById(i),n=e.parentNode,h=n.offsetWidth,l=n.offsetHeight;e.width=h*t,e.height=l*t;var d=e.getContext("2d"),y=new Array;for(u.bounds=new c(h,l),s=0;s<11;s++)y[s]=new u(o()*h,-o()*l*2,30,8,8,45,1,.05);var f=new Array;for(p.bounds=new c(h,l),s=0;s<95;s++)f[s]=new p(o()*h,o()*l);this.resize=function(){h=n.offsetWidth,l=n.offsetHeight,e.width=h*t,e.height=l*t,p.bounds=new c(h,l),u.bounds=new c(h,l)},this.start=function(){this.stop();this.update()},this.stop=function(){a(this.interval)};var x=0;this.update=function(){var t=0;for(d.clearRect(0,0,e.width,e.height),t=0;t<95;t++)f[t].Update(.02),f[t].Draw(d);for(t=0;t<11;t++)y[t].Update(.02),y[t].Draw(d);for(this.interval=r(function(){confetti.update()}),d.save(),d.font=fontSize+"px "+fontFace,d.fillStyle="red",d.textAlign="center";d.measureText(ThursdayText).width>e.width;)fontSize--,d.font=fontSize+"px "+fontFace;d.translate(e.width/2,e.height/2),d.rotate(x*Math.PI/180),x+=.5,x>=360&&(x=0),d.translate(-e.width/2,-e.height/2),d.fillText(ThursdayText,e.width/2,e.height/2),d.restore()}},confetti=new confetti.Context("confettiWidget"),confetti.start(),window.addEventListener("resize",function(t){confetti.resize()})})}function TodayIsThursday(){1==simulated&&(ThursdayText+=" (SIMULATED)"),doConfetti(),audio=new Audio("/resources/audio/mariachi.ogg"),audio.volume=.1,audio.loop=!0,audio.autoplay=!0}function StopThursday(){audio.pause(),confetti.stop(),$("#confettiWidget").remove(),document.getElementById("stopThursdayButton").parentElement.removeChild(document.getElementById("stopThursdayButton"))}function CheckForThursday(){IsItThursday()&&TodayIsThursday(!1)}function IsItThursday(){if(4==(new Date).getDay())return simulated=!1,!0;if(window.location.hash){if("thursday"==window.location.hash.substring(1).toLowerCase())return simulated=!0,!0}return!1}var ThursdayText="IT'S THURSDAY",fontSize=90,fontFace="Rye",confetti,audio,simulated=!1;CheckForThursday(),$(document).ready(function(t){$("#stopThursdayButton").on("click",function(t){StopThursday()}),IsItThursday()?document.getElementById("stopThursdayButton").style.visibility="visible":document.getElementById("stopThursdayButton").style.visibility="hidden"});