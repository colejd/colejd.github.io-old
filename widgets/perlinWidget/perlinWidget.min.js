function determineDirectionality(){var e=Math.random()*Math.PI;options.strength=e,.75>e&&(options.strength=0)}function throttleStreams(){for(;options.numStreams>streams.length;)streams.push(createStream());for(;options.numStreams<streams.length;)streams.shift()}function setCanvasSize(){canvas.style.width="100%",canvas.style.height="100%",canvas.width=window.innerWidth,canvas.height=.05*window.innerHeight,bounds.set(0,0,canvas.width,canvas.height)}function createStream(){var e=getRandomVector();return e.color=palette[Math.floor(Math.random()*palette.length)].toRGBACSS(),e}function getRandomVector(){return new toxi.geom.Vec2D(Math.random(),Math.random()).scaleSelf(canvas.width,canvas.height)}function draw(){var n,e=0,t=streams.length;for(offset+=options.distort,ctx.fillStyle="rgba(0,0,0,0.05)",ctx.fillRect(0,0,canvas.width,canvas.height);t>e;e++){n=streams[e],ctx.strokeStyle=n.color,lastPos.set(n),pt.set(n).scaleSelf(options.scalar).addSelf(0,offset);var i=perlin.noise(pt.x,pt.y)-.5,r=options.strength*i,s=toxi.geom.Vec2D.fromTheta(r);n.addSelf(s.normalizeTo(3*options.step)),ctx.beginPath(),ctx.moveTo(lastPos.x,lastPos.y),ctx.lineTo(n.x,n.y),ctx.closePath(),ctx.stroke(),bounds.containsPoint(n)||n.set(getRandomVector())}options.running&&window.requestAnimationFrame(draw)}var canvas=document.getElementById("perlin-canvas"),ctx=canvas.getContext("2d"),perlin=new toxi.math.noise.PerlinNoise,bounds=new toxi.geom.Rect,lastPos=new toxi.geom.Vec2D,gui,offset=0,options,streams=[],palette;palette=[toxi.color.TColor.newHex("1c0f17"),toxi.color.TColor.newHex("271d2e"),toxi.color.TColor.newHex("2c3857"),toxi.color.TColor.newHex("155e73").setBrightness(.9),toxi.color.TColor.newHex("e8ca59"),toxi.color.TColor.newHex("891b1b")],options={running:!0,numStreams:50,distort:0,strength:0,scalar:.05,step:1},determineDirectionality(),setCanvasSize(),ctx.fillStyle="#151515",ctx.strokeStyle="#ff0000",ctx.lineWidth=1.5,throttleStreams(),window.onload=draw;var pt=new toxi.geom.Vec2D;window.addEventListener("resize",setCanvasSize,!1);